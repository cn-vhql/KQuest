# KQuest Web UI 使用指南

KQuest Web UI 是一个基于Streamlit的图形化界面，为知识图谱抽取和问答系统提供直观的操作体验。

## 功能特性

### 🎯 核心功能
- **配置管理**: 可视化配置OpenAI API和抽取参数
- **知识抽取**: 上传文档，一键抽取知识三元组
- **智能问答**: 基于知识图谱的智能问答系统
- **图谱可视化**: 知识图谱统计信息和网络结构展示
- **系统信息**: 实时系统状态和配置信息

### 🎨 界面特色
- 响应式设计，支持多设备访问
- 实时进度显示和状态反馈
- 丰富的数据可视化图表
- 交互式三元组浏览和搜索

## 快速开始

### 1. 安装依赖

```bash
# 安装项目依赖
uv sync

# 或使用pip
pip install -e .
```

### 2. 启动Web UI

```bash
# 使用便捷脚本启动
python run_web.py

# 或直接使用streamlit
streamlit run src/kquest/web_ui.py
```

### 3. 访问界面

打开浏览器访问：http://localhost:8501

## 详细使用说明

### 配置管理页面

#### OpenAI API 配置
- **API Key**: 必填，您的OpenAI API密钥
- **Base URL**: 可选，自定义API端点
- **模型选择**: 支持GPT-3.5-turbo、GPT-4等模型
- **Temperature**: 控制生成文本的随机性（0.0-2.0）
- **Max Tokens**: 单次请求的最大token数量

#### 知识抽取配置
- **文档分块大小**: 将文档分割的字符数（默认2000）
- **分块重叠大小**: 相邻分块的重叠字符数（默认200）
- **置信度阈值**: 过滤低置信度三元组的阈值（默认0.5）

### 知识抽取页面

#### 支持的文件格式
- **TXT**: 纯文本文件
- **MD**: Markdown格式文件
- **JSON**: JSON格式文件

#### 抽取流程
1. 上传文档文件
2. 预览文件内容
3. 设置抽取参数
4. 点击"开始抽取"
5. 查看抽取结果

#### 结果展示
- **统计信息**: 三元组数量、处理时间、实体统计
- **三元组列表**: 可过滤、可搜索的三元组展示
- **详细信息**: 每个三元组的类型、置信度、来源等元数据

### 智能问答页面

#### 问答功能
- **问题输入**: 支持自然语言问题
- **三种推理模式**:
  - 📊 **纯图算法**: 基于传统图算法的快速推理，适合简单查询
  - 🔗 **混合推理**: 结合图算法与LLM语义理解，平衡性能和质量
  - 🚀 **LLM驱动**: 大模型为主体的智能推理，适合复杂分析

#### 推理模式对比

| 模式 | 速度 | 质量 | 适用场景 |
|------|------|------|----------|
| 📊 纯图算法 | ⚡ 极快 | ⭐ 基础 | 快速查询、简单关系查找 |
| 🔗 混合推理 | 🚶 中等 | ⭐⭐ 高 | 平衡性能、一般性问题 |
| 🚀 LLM驱动 | 🐌 较慢 | ⭐⭐⭐ 最高 | 复杂分析、深度推理 |

#### 问答示例
```
什么是人工智能？
张三和李四有什么关系？
列出所有的产品特性？
```

#### 使用建议
- **快速测试**: 使用纯图算法模式
- **日常使用**: 推荐混合推理模式
- **复杂问题**: 使用LLM驱动模式

#### 结果展示
- **回答**: 系统生成的答案
- **置信度**: 回答的可信度评分
- **推理模式**: 显示使用的推理模式（📊纯图算法/🔗混合推理/🚀LLM驱动）
- **推理方法**: 具体的推理技术细节
- **推理过程**: 详细的推理步骤
- **来源三元组**: 支持回答的知识三元组
- **历史记录**: 最近的问答记录，包含推理模式信息

### 图谱可视化页面

#### 统计信息
- 三元组总数、唯一实体数、关系数
- 三元组类型分布（饼图）
- 置信度分布（柱状图）

#### 网络结构
- 基于NetworkX的实体关系网络图
- 支持最多50个三元组的可视化
- 节点表示实体，边表示关系

#### 关系统计
- 按使用频率排序的关系列表
- 每种关系的出现次数统计

## 高级功能

### 批量处理
虽然Web UI主要设计为交互式使用，但您可以：
- 逐个上传多个文件进行抽取
- 将结果保存为不同格式
- 通过API进行批量处理

### 数据导出
通过命令行工具，您可以将抽取的知识图谱导出为多种格式：
```bash
# 导出为JSON格式
kquest info --kg output/kg.json --format json

# 导出为RDF格式
kquest info --kg output/kg.json --format rdf
```

## 故障排除

### 常见问题

#### 1. API Key错误
**问题**: 配置保存失败
**解决**:
- 检查API Key是否正确
- 确认网络连接正常
- 验证API账户余额

#### 2. 文件上传失败
**问题**: 无法上传文件
**解决**:
- 检查文件格式是否支持
- 确认文件大小不超过限制
- 验证文件编码为UTF-8

#### 3. 抽取结果为空
**问题**: 没有抽取到三元组
**解决**:
- 降低置信度阈值
- 检查文档内容质量
- 尝试调整分块大小

#### 4. 问答无响应
**问题**: 问答功能无结果
**解决**:
- 确认知识图谱已创建
- 检查问题表述是否清晰
- 尝试启用推理模式

### 性能优化

#### 大文档处理
- 适当增加分块大小
- 调整重叠参数
- 考虑分割文档为多个小文件

#### 网络优化
- 使用更快的模型（如GPT-4）
- 调整并发参数
- 优化提示词模板

## 扩展开发

### 自定义界面
Web UI采用模块化设计，您可以：
- 修改`src/kquest/web_ui.py`添加新功能
- 自定义样式和主题
- 集成第三方组件

### API集成
Web UI可以与现有API集成：
- 添加认证和授权
- 集成用户管理
- 支持多租户架构

## 技术架构

### 前端技术
- **Streamlit**: Web应用框架
- **Matplotlib**: 数据可视化
- **NetworkX**: 图网络可视化
- **Pandas**: 数据处理

### 后端集成
- **Pydantic**: 数据验证
- **OpenAI API**: 语言模型服务
- **AsyncIO**: 异步处理

### 数据流程
1. 用户上传文档
2. 文档分块处理
3. LLM抽取三元组
4. 结果存储和展示
5. 问答查询和推理

## 更新日志

### v0.1.0
- 初始版本发布
- 基础的知识抽取功能
- 问答系统集成
- 可视化界面

## 支持与反馈

如有问题或建议，请：
1. 查看本文档的故障排除部分
2. 检查项目的GitHub Issues
3. 提交新的Issue或Pull Request

---

**注意**: Web UI主要用于演示和测试，生产环境建议使用API接口进行集成。